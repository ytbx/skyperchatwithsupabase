var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,i=Object.getPrototypeOf,a=Object.prototype.hasOwnProperty,o=(e,i,o,s)=>{if(i&&typeof i==`object`||typeof i==`function`)for(var c=r(i),l=0,u=c.length,d;l<u;l++)d=c[l],!a.call(e,d)&&d!==o&&t(e,d,{get:(e=>i[e]).bind(null,d),enumerable:!(s=n(i,d))||s.enumerable});return e},s=(n,r,a)=>(a=n==null?{}:e(i(n)),o(r||!n||!n.__esModule?t(a,`default`,{value:n,enumerable:!0}):a,n));let c=require(`node:child_process`),l=require(`node:os`),u=require(`node:path`);u=s(u),((0,l.platform)()!==`win32`||(0,l.arch)()!==`x64`)&&console.warn(`This package is currently only available for Windows 10 x64 and later`);let d=u.default.resolve(__dirname,`../`,`bin`);function f(e){d=e}function p(){return u.default.resolve(d,`${(0,l.platform)()}-${(0,l.arch)()}`,`ApplicationLoopback.exe`)}function m(){return u.default.resolve(d,`${(0,l.platform)()}-${(0,l.arch)()}`,`ProcessList.exe`)}async function h(){let e=(0,c.spawn)(m(),{detached:!0,stdio:`pipe`});return e.stdout.setEncoding(`utf8`),new Promise(t=>{let n=[],r=``;e.stdout.on(`data`,e=>{r+=e}),e.stdout.on(`close`,()=>{let e=r.split(/\r?\n/);for(let t of e){let e=t.split(`;`);if(e.length>=3){let t=e[0].trim(),r=e[1].trim(),i=e[2].trim();t&&r&&n.push({processId:t,hwnd:r,title:i})}}t(n)}),e.on(`error`,e=>{console.error(`[native-audio-loopback] ProcessList spawn error:`,e),t([])})})}const g=new Map;function _(e,t){if(g.has(e))throw Error(`An audio capture with process id of ${e} is already started`);let n=[e,t.mode||`include`],r=(0,c.spawn)(`${u.default.resolve(__dirname,p())}`,n,{detached:!0,stdio:`pipe`});return g.set(e,r),r.stdout.on(`data`,e=>{t.onData?.(e)}),e}function v(e){let t=g.get(e);return t?(t.kill(),g.delete(e),!0):!1}function y(e,t){return _(e,{onData:t.onData,mode:`exclude`})}async function b(e){let t=e.toString().trim(),n=await h();console.log(`[native-audio-loopback] Searching for PID for HWND: "${t}"`);let r=n.find(e=>e.hwnd===t);return r?(console.log(`[native-audio-loopback] ✓ Found PID: ${r.processId} for HWND: ${t} (${r.title})`),r.processId):(console.warn(`[native-audio-loopback] ✗ FAILED to find PID for HWND: "${t}"`),null)}exports.captureSystemAudioExcluding=y,exports.getActiveWindowProcessIds=h,exports.getLoopbackBinaryPath=p,exports.getProcessListBinaryPath=m,exports.getWindowPid=b,exports.setExecutablesRoot=f,exports.startAudioCapture=_,exports.stopAudioCapture=v;